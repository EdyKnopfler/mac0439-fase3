{% load l10n %}
{% csrf_token %}

<link rel="stylesheet" href="http://code.jquery.com/ui/1.8.18/themes/base/jquery-ui.css" type="text/css" media="all" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js" type="text/javascript"></script>

 <p>
 Título: <br>
 <input type="text" name="titulo" maxlength="80" value="{{post.titulo}}">
 </p>

 <p>
 Texto: <br>
 <textarea name="texto">{{post.texto}}</textarea>
 </p>

 <p>
 <div class="ui-widget">
   Marcar usuários: <br>
   <select multiple name ="marcados" id="marcados">
     {% for m in post.marcados %}
       <option selected value = "{{m.nome}}"> {{m.nome}} </option>
     {% endfor %}
   </select>
 </p>
   <input id="autocomplete-user">
   <input id="clickMe" type="button" value="Marcar Usuário" onclick="marcar();" />
 </div>

 <script type="text/javascript">
    $(document).ready(function(){
        var location_input=$('input[id="autocomplete-user"]');
        location_input.autocomplete({
          source: "/perfil/get_user_names/",
          minLength: 2
        });
      } );

    function marcar() {
      var nome = $('input[id="autocomplete-user"]').val();
      // var marcados = $("#marcados").val();
      // for(var i=0, len = $("#marcados").length; i < len && marcados != null; i++){
      //   if( marcados[i] == nome)
      //     var aux = "#marcados option[value= '"+nome+"'']";
      //     $("#marcados option[value= '"+nome+"']").remove();
      // }
      $("#marcados").append($( "<option selected> ",{ value : nome}).text(nome));
      $('#marcados').size = "2";

    }
</script>
 </p>

 <p>
 Foto: <br>
 {% if post.arquivo %}<img src="../../../static/media/{{post.arquivo}}"> {% endif %}
 <input type="file" name="pic" accept="image/*">
</p>
